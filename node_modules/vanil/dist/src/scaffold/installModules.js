"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.installModules = void 0;
const cross_spawn_1 = require("cross-spawn");
const concatErrors_1 = require("./concatErrors");
const installModules = async (projectRootDir, dependencies, devDependencies) => {
    await new Promise((resolve, reject) => {
        console.log();
        console.log('Installing dependencies...');
        const child = (0, cross_spawn_1.spawn)('npm', ['--prefix', projectRootDir, 'install', ...dependencies], { stdio: 'inherit' });
        child.on('close', (code) => {
            if (code !== 0) {
                (0, concatErrors_1.concatErrors)([`npm exited with error code: ${code}`]);
                reject(code);
            }
            else {
                resolve(undefined);
            }
        });
    });
    await new Promise((resolve, reject) => {
        process.chdir(projectRootDir);
        console.log('Installing dev dependencies...');
        const child = (0, cross_spawn_1.spawn)('npm', ['--prefix', projectRootDir, 'install', ...devDependencies, '--save-dev'], {
            stdio: 'inherit',
        });
        child.on('close', async (code) => {
            if (code !== 0) {
                (0, concatErrors_1.concatErrors)([`npm exited with error code: ${code}`]);
                reject(code);
            }
            else {
                resolve(undefined);
            }
        });
    });
    return true;
};
exports.installModules = installModules;
